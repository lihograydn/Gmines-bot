<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Gmines Casino</title>
<style>
body { 
    font-family: Arial, sans-serif; 
    text-align: center; 
    background: #f0f0f0; 
}
h1 { 
    margin-top: 20px; 
}
#menu, #profileSection, #minesSection, #game, #bonusSection, #topSection, #adminLogSection { 
    display: none; 
    margin-top: 20px; 
}
.row { 
    display: flex; 
    justify-content: center; 
}
.cell { 
    width: 50px; 
    height: 50px; 
    margin: 2px; 
    font-size: 24px; 
    background: #ccc; 
    border: 1px solid #999; 
    cursor: pointer; 
    display: flex; 
    justify-content: center; 
    align-items: center; 
    user-select: none;
}
.revealed { 
    background: #eee; 
    cursor: default; 
}
.flag { 
    color: green; 
    font-weight: bold; 
}
#info { 
    margin-top: 10px; 
}
button { 
    font-size: 16px; 
    padding: 5px 10px; 
    margin: 2px; 
    border-radius: 8px; /* –∑–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏ */
    cursor: pointer;
}
input { 
    width: 80px; 
    font-size: 16px; 
}
select { 
    font-size: 16px; 
}
#gameControls { 
    margin-bottom: 10px; 
}
#adminLogSection { 
    max-height: 200px; 
    overflow-y: scroll; 
    border: 1px solid #999; 
    background:#fff; 
    padding:5px; 
    margin:10px; 
}
</style>
</head>
<body>

<h1>Gmines Casino</h1>

<!-- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é -->
<div id="menu">
  <button id="profileBtnMenu">–ü—Ä–æ—Ñ–∏–ª—å üë§</button>
  <button id="minesBtnMenu">–ú–∏–Ω—ã</button>
  <button id="bonusBtnMenu">–ë–æ–Ω—É—Å üí∞</button>
  <button id="topBtnMenu">–¢–æ–ø 10 üèÜ</button>
</div>

<!-- –ü—Ä–æ—Ñ–∏–ª—å -->
<div id="profileSection">
  <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
  <p>ID: <span id="playerID">0</span></p>
  <p>–ë–∞–ª–∞–Ω—Å: <span id="balance">0</span></p>
  <p>–í—Å–µ–≥–æ –∏–≥—Ä: <span id="totalGames">0</span></p>
  <p>–í—ã–∏–≥—Ä–∞–Ω–æ: <span id="wins">0</span></p>
  <p>–ü—Ä–æ–∏–≥—Ä–∞–Ω–æ: <span id="losses">0</span></p>
  <button id="backFromProfile">–ù–∞–∑–∞–¥</button>
</div>

<!-- –ú–∏–Ω—ã -->
<div id="minesSection">
  <h2>–ú–∏–Ω—ã 5x5</h2>
  <label>–°—Ç–∞–≤–∫–∞: <input type="number" id="stakeInput" min="1" value="100"></label>
  <label>–ú–∏–Ω—ã: <select id="minesSelect"></select></label>
  <br><br>
  <button id="startGameBtn">–ù–∞—á–∞—Ç—å –∏–≥—Ä—É</button>
  <button id="backFromMines">–ù–∞–∑–∞–¥</button>
</div>

<!-- –ë–æ–Ω—É—Å -->
<div id="bonusSection">
  <h2>–ë–æ–Ω—É—Å —Ä–∞–∑ –≤ —á–∞—Å</h2>
  <p id="bonusInfo"></p>
  <button id="getBonusBtn">–ü–æ–ª—É—á–∏—Ç—å –±–æ–Ω—É—Å</button>
  <button id="backFromBonus">–ù–∞–∑–∞–¥</button>
</div>

<!-- –¢–æ–ø 10 -->
<div id="topSection">
  <h2>–¢–æ–ø 10 –ø–æ –±–∞–ª–∞–Ω—Å—É</h2>
  <ol id="topList"></ol>
  <button id="backFromTop">–ù–∞–∑–∞–¥</button>
</div>

<!-- –ê–¥–º–∏–Ω-–∫–Ω–æ–ø–∫–∞ -->
<button id="adminGiveCoins" style="display:none;">–í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã</button>

<!-- –õ–æ–≥ –∞–¥–º–∏–Ω–∞ -->
<div id="adminLogSection"></div>

<!-- –ò–Ω—Ñ–æ –∏ –∫–Ω–æ–ø–∫–∏ –∏–≥—Ä—ã -->
<div id="info">
  –ë–∞–ª–∞–Ω—Å: <span id="balanceGame">0</span> | 
  –°—Ç–∞–≤–∫–∞: <span id="stakeDisplay">0</span> | 
  –ú–Ω–æ–∂–∏—Ç–µ–ª—å: <span id="multiplier">1.00</span>x
  <button id="cashOut">–ó–∞–±—Ä–∞—Ç—å</button>
</div>

<div id="gameControls">
  <button id="backToMenu">–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é</button>
</div>

<!-- –ò–≥—Ä–æ–≤–æ–µ –ø–æ–ª–µ -->
<div id="game"></div>

<script>
// --------------------- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---------------------
let playerData = JSON.parse(localStorage.getItem('playerData')) || {
    balance: 1000, totalGames: 0, wins: 0, losses: 0, lastBonus: 0, id: 395852120
};
let topPlayers = JSON.parse(localStorage.getItem('topPlayers')) || [];
let adminLog = JSON.parse(localStorage.getItem('adminLog')) || [];

if(!playerData.id){
    playerData.id = Math.floor(Math.random() * 900000000) + 100000000; // 9-–∑–Ω–∞—á–Ω—ã–π ID
    savePlayerData();
}

let stake = 0, multiplier = 1.0, maxBonus = 3.0;
let width = 5, height = 5;
let minesCount = 5;
let board = [], revealed = [], flags = [];
let totalSafe = 0, openedSafe = 0, gameOver = false;

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è select —Å –º–∏–Ω
const minesSelect = document.getElementById('minesSelect');
for(let i=1;i<=24;i++){ let opt = document.createElement('option'); opt.value=i; opt.text=i; minesSelect.appendChild(opt); }

// --------------------- –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é ---------------------
function showMenu(){ 
    document.getElementById('menu').style.display='block';
    document.getElementById('profileSection').style.display='none';
    document.getElementById('minesSection').style.display='none';
    document.getElementById('bonusSection').style.display='none';
    document.getElementById('topSection').style.display='none';
    document.getElementById('game').style.display='none';
    document.getElementById('info').style.display='none';
    document.getElementById('gameControls').style.display='none';
    document.getElementById('adminLogSection').style.display='none';
}

// --------------------- –ü—Ä–æ—Ñ–∏–ª—å ---------------------
document.getElementById('profileBtnMenu').onclick = function(){
    document.getElementById('menu').style.display='none';
    document.getElementById('profileSection').style.display='block';
    document.getElementById('balance').innerText = playerData.balance;
    document.getElementById('totalGames').innerText = playerData.totalGames;
    document.getElementById('wins').innerText = playerData.wins;
    document.getElementById('losses').innerText = playerData.losses;
    document.getElementById('playerID').innerText = playerData.id;
};
document.getElementById('backFromProfile').onclick = showMenu;

// --------------------- –ú–∏–Ω—ã ---------------------
document.getElementById('minesBtnMenu').onclick = function(){
    document.getElementById('menu').style.display='none';
    document.getElementById('minesSection').style.display='block';
};
document.getElementById('backFromMines').onclick = showMenu;

// --------------------- –ë–æ–Ω—É—Å ---------------------
document.getElementById('bonusBtnMenu').onclick = function(){
    document.getElementById('menu').style.display='none';
    document.getElementById('bonusSection').style.display='block';
    updateBonusInfo();
};
document.getElementById('backFromBonus').onclick = showMenu;

function updateBonusInfo(){
    let now = Date.now();
    let diff = now - playerData.lastBonus;
    if(diff >= 3600000) document.getElementById('bonusInfo').innerText = "–ë–æ–Ω—É—Å –¥–æ—Å—Ç—É–ø–µ–Ω!";
    else{
        let min = Math.ceil((3600000 - diff)/60000);
        document.getElementById('bonusInfo').innerText = `–°–ª–µ–¥—É—é—â–∏–π –±–æ–Ω—É—Å —á–µ—Ä–µ–∑ ${min} –º–∏–Ω—É—Ç`;
    }
}
document.getElementById('getBonusBtn').onclick = function(){
    let now = Date.now();
    if(now - playerData.lastBonus >= 3600000){
        let bonus = Math.floor(Math.random()*1001)+500;
        playerData.balance += bonus;
        playerData.lastBonus = now;
        savePlayerData();
        updateBonusInfo();
        alert(`–í—ã –ø–æ–ª—É—á–∏–ª–∏ –±–æ–Ω—É—Å: ${bonus}!`);
    } else alert("–ë–æ–Ω—É—Å –µ—â—ë –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω");
};

// --------------------- –¢–æ–ø 10 ---------------------
document.getElementById('topBtnMenu').onclick = function(){
    document.getElementById('menu').style.display='none';
    document.getElementById('topSection').style.display='block';
    updateTopList();
};
document.getElementById('backFromTop').onclick = showMenu;

function updateTopList(){
    let list = document.getElementById('topList');
    list.innerHTML='';
    topPlayers.sort((a,b)=>b.balance-a.balance);
    topPlayers.slice(0,10).forEach(p=>{
        let li = document.createElement('li');
        li.innerText = `${p.name}: ${p.balance}`;
        list.appendChild(li);
    });
}

// --------------------- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ ---------------------
function savePlayerData(){
    localStorage.setItem('playerData', JSON.stringify(playerData));
    updateTopPlayers();
}
function updateTopPlayers(){
    let existing = topPlayers.find(p=>p.name==='–ò–≥—Ä–æ–∫');
    if(existing) existing.balance = playerData.balance;
    else topPlayers.push({name:'–ò–≥—Ä–æ–∫', balance:playerData.balance});
    localStorage.setItem('topPlayers', JSON.stringify(topPlayers));
}

// --------------------- –ê–¥–º–∏–Ω –∫–Ω–æ–ø–∫–∞ ---------------------
const adminBtn = document.createElement('button');
adminBtn.innerText = "–í—ã–¥–∞—Ç—å –º–æ–Ω–µ—Ç—ã";
adminBtn.onclick = function(){
    let amount = parseInt(prompt("–í–≤–µ–¥–∏—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–Ω–µ—Ç –¥–ª—è –≤—ã–¥–∞—á–∏:"));
    if(amount && amount>0){
        playerData.balance += amount;
        savePlayerData();
        document.getElementById('balance').innerText = playerData.balance;
        document.getElementById('balanceGame').innerText = playerData.balance;
        alert(`–í—ã –≤—ã–¥–∞–ª–∏ —Å–µ–±–µ ${amount} –º–æ–Ω–µ—Ç`);
    }
};

// –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–¥–º–∏–Ω-–∫–Ω–æ–ø–∫—É —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–≤–æ–µ–≥–æ ID
if(playerData.id == 395852120){
    document.getElementById('menu').appendChild(adminBtn);
}

// --------------------- –ù–∞—á–∞–ª–æ –∏–≥—Ä—ã ---------------------
document.getElementById('startGameBtn').onclick = function(){
    stake = parseInt(document.getElementById('stakeInput').value);
    if(!stake || stake <1 || stake>playerData.balance){ alert("–ù–µ–≤–µ—Ä–Ω–∞—è —Å—Ç–∞–≤–∫–∞"); return; }
    playerData.balance -= stake; savePlayerData();
    document.getElementById('balanceGame').innerText = playerData.balance;
    document.getElementById('stakeDisplay').innerText = stake;

    minesCount = parseInt(minesSelect.value);

    document.getElementById('minesSection').style.display='none';
    document.getElementById('game').style.display='block';
    document.getElementById('info').style.display='block';
    document.getElementById('gameControls').style.display='block';

    startGame();
}

// --------------------- –ö–Ω–æ–ø–∫–∞ ¬´–ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é¬ª ---------------------
document.getElementById('backToMenu').onclick = function(){
    gameOver = true;
    document.getElementById('game').style.display='none';
    document.getElementById('info').style.display='none';
    document.getElementById('gameControls').style.display='none';
    showMenu();
}

// --------------------- –ö–Ω–æ–ø–∫–∞ ¬´–ó–∞–±—Ä–∞—Ç—å¬ª ---------------------
document.getElementById('cashOut').onclick = function(){
    if(gameOver) return;
    let winAmount = Math.round(stake*multiplier);
    playerData.balance += winAmount; savePlayerData();
    document.getElementById('balanceGame').innerText = playerData.balance;
    stake=0; document.getElementById('stakeDisplay').innerText=stake;
    gameOver=true;
}

// --------------------- –§—É–Ω–∫—Ü–∏–∏ –∏–≥—Ä—ã ---------------------
function startGame(){
    board = Array(height).fill().map(()=>Array(width).fill(0));
    revealed = Array(height).fill().map(()=>Array(width).fill(false));
    flags = Array(height).fill().map(()=>Array(width).fill(false));
    openedSafe=0; totalSafe=width*height-minesCount; multiplier=1.0; gameOver=false;
    document.getElementById('multiplier').innerText=multiplier.toFixed(2);
    playerData.totalGames++;

    const gameDiv=document.getElementById('game');
    gameDiv.innerHTML='';
    for(let y=0;y<height;y++){
        const rowDiv=document.createElement('div'); rowDiv.className='row';
        for(let x=0;x<width;x++){
            const cell=document.createElement('div'); cell.className='cell';
            cell.dataset.x=x; cell.dataset.y=y;
            cell.oncontextmenu=function(e){e.preventDefault(); rightClick(x,y);};
            cell.onclick=function(){leftClick(x,y);};
            rowDiv.appendChild(cell);
        }
        gameDiv.appendChild(rowDiv);
    }
    generateMines();
}

function generateMines(){
    let placed=0;
    while(placed<minesCount){
        let x=Math.floor(Math.random()*width), y=Math.floor(Math.random()*height);
        if(board[y][x]===-1) continue;
        board[y][x]=-1; placed++;
    }
}

function updateMultiplier(){
    multiplier = 1.0 + (openedSafe/totalSafe)*maxBonus;
    document.getElementById('multiplier').innerText = multiplier.toFixed(2);
}

function leftClick(x,y){
    if(gameOver || revealed[y][x] || flags[y][x]) return;
    const cellDiv = document.querySelector(`.cell[data-x='${x}'][data-y='${y}']`);
    if(board[y][x]===-1){ cellDiv.innerText='üí£'; cellDiv.classList.add('revealed'); endGame(false); return;}
    revealed[y][x]=true; openedSafe++; cellDiv.innerText='üíé'; cellDiv.classList.add('revealed'); updateMultiplier();
    if(openedSafe===totalSafe) endGame(true);
}

function rightClick(x,y){
    if(gameOver || revealed[y][x]) return;
    const cellDiv=document.querySelector(`.cell[data-x='${x}'][data-y='${y}']`);
    if(!flags[y][x]){ flags[y][x]=true; cellDiv.innerText='üö©'; cellDiv.classList.add('flag'); }
    else{ flags[y][x]=false; cellDiv.innerText=''; cellDiv.classList.remove('flag'); }
}

function endGame(win){
    gameOver=true;
    for(let y=0;y<height;y++){
        for(let x=0;x<width;x++){
            const cellDiv=document.querySelector(`.cell[data-x='${x}'][data-y='${y}']`);
            if(board[y][x]===-1){
                if(flags[y][x]) cellDiv.style.background='green';
                else{ cellDiv.innerText='üí£'; cellDiv.style.background='red'; }
            }
            cellDiv.onclick=null; cellDiv.oncontextmenu=null;
        }
    }
    if(win){
        let winAmount=Math.round(stake*multiplier);
        playerData.balance += winAmount; playerData.wins++; savePlayerData();
    } else {
        playerData.balance=0; playerData.losses++; savePlayerData();
    }
}

document.getElementById('balanceGame').innerText = playerData.balance;
document.getElementById('playerID').innerText = playerData.id;
showMenu();
</script>
</body>
</html>

